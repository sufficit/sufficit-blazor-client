@using Sufficit.Blazor.UI.Material
@using Sufficit.Blazor.UI.Material.Services
@using Sufficit.Blazor.Client.Models
@inherits LayoutComponentBase

<CascadingValue Value="@TextSearch">
    <SideBarContext>
        <SideBarMaterial />
        <div class="main-content position-relative bg-gray-100 h-100">
            <NavBarMaterial />
            <div class="container-fluid px-2 px-md-4" style="min-height: 500px">
                @Body
            </div>
            <div class="fillheight"></div>
            <FooterMaterial />  
        </div>
        <MaterialFixedPlugin />
    </SideBarContext>
</CascadingValue>

@code{
    [Inject]
    public BlazorUIMaterialService UIService { get; internal set; } = default!;

    [Inject]
    public NavigationManager Navigation { get; internal set; } = default!;

    public TextSearchControl? TextSearch { get; internal set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        TextSearch = new TextSearchControl(Navigation);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await UIService.EnsureIsLoaded();
        }
    }
}