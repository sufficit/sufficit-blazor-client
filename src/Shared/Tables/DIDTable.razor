@using Sufficit.Telephony;

<MudTable @ref="Table"
          T="DirectInwardDialing"
          LoadingProgressColor="Color.Info"
          ServerData="GetData"
          Breakpoint="Breakpoint.Sm" 
          Hover="true"
          Class="my-3">
    <LoadingContent>
        <MudSkeleton Animation="Animation.Wave" Height="200px" />
    </LoadingContent>
    <HeaderContent>
        <MudTh Style="text-align: center; width: 130px">Ações</MudTh>
        <MudTh Style="width: 200px">Extensão</MudTh>
        <MudTh>Descrição</MudTh>
        <MudTh Style="text-align: center; width: 50px"></MudTh>
        <MudTh Style="text-align: center; width: 50px">Canais</MudTh>
        <MudTh Style="text-align: center; width: 100px">Cadastro</MudTh>
        <MudTh Style="text-align: center; width: 50px">Fornecedor</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Ações">
            <MudTooltip Text="Editar opções">
                <MudLink Href="@(Pages.Telephony.DirectInwardDialing.Object.RouteParameter + $"?id={context.Id}")" Underline="Underline.None" Class="mx-1">
                    <MudIconButton Icon="@Icons.Material.Filled.Edit" Variant="Variant.Filled" Size="Size.Small"></MudIconButton>
                </MudLink>
            </MudTooltip>
            <MudTooltip Text="Histórico de atualizações">
                <MudLink Href="@(Pages.Logging.Events.RouteParameter + $"?classname={nameof(DirectInwardDialing)}&eventcontextid={context.Id}")" Underline="Underline.None" Class="mx-1">
                    <MudIconButton Icon="@Icons.Material.Filled.History" Variant="Variant.Filled" Size="Size.Small"></MudIconButton>
                </MudLink>
            </MudTooltip>
        </MudTd>
        <MudTd DataLabel="Extensão">@ToE164Semantic(context.Extension)</MudTd>
        <MudTd DataLabel="Descrição">@context.Description</MudTd>
        <MudTd DataLabel="Opções" Style="text-align: center;">
            <MudStack Row="true">
                @if (!string.IsNullOrWhiteSpace(context.Filter))
                {
                    <MudTooltip Text="@context.Filter">
                        <MudIcon Icon="@Icons.Material.Filled.FilterAlt" Size="Size.Small"></MudIcon>
                    </MudTooltip>
                }
                @if (!string.IsNullOrWhiteSpace(context.Tags))
                {
                    <MudTooltip Text="@context.Tags">
                        <MudIcon Icon="@Icons.Material.Filled.Tag" Size="Size.Small"></MudIcon>
                    </MudTooltip>
                }
                @if (context.Billed)
                {
                    <MudIcon Icon="@Icons.Material.Filled.AttachMoney" Size="Size.Small"></MudIcon>
                }
            </MudStack>
        </MudTd>
        <MudTd DataLabel="Canais" Style="text-align: center;">@context.MaxChannels</MudTd>
        <MudTd DataLabel="Cadastro" Style="text-align: center;">@context.Register.ToString("dd/MM/yyyy")</MudTd>
        <MudTd DataLabel="Fornecedor" Style="text-align: center;">
            <AsyncBlock Action="@GetTitle(@context.ProviderId)" Context="Provedor">
                <MudTooltip Text="@Provedor">
                    <ContactAvatar ReferenceId="@context.ProviderId"></ContactAvatar>
                </MudTooltip>
            </AsyncBlock>
        </MudTd>
    </RowTemplate>
</MudTable>